
## UDNS简介
UDNS服务是UCloud提供的高可用、可扩展的域名解析服务系统。利用UDNS提供的内网解析服务，可以用于实现服务发现、负载均衡、服务高可用等场景。

## DNS服务简介
DNS（Domain Name System），是目前互联网依赖的一项服务，作为将域名和IP地址互相映射的系统，使人和业务都能更方便的访问互联网资源。DNS默认使用TCP和UDP的53端口。实际上，DNS查询一般使用UDP协议，使用TCP的情况非常罕见。UDNS系统提供的就是UDP的服务。

DNS最核心的功能是将域名转换为IP地址，从而摆脱服务对于IP地址的依赖，通过对域名的操作，实现以下功能：
- 服务发现

![images](/images/服务发现2.png)
如上图，客户端将域名配置在客户端的请求中。服务端则分别向UDNS系统进行注册，这样客户端就可以通过DNS非常方便的发现后端服务地址。服务IP地址发生迁移，客户端的配置也无需更改，修改UDNS中的DNS配置即可进行服务地址的切换。

- 负载均衡

![images](/images/负载均衡.png)
如上图，UDNS支持“随机应答”模式，用户可以配置这种模式的A记录和AAAA记录。UDNS根据配置的记录的值和权重，可随机返回相应的值，从而按照权重，将客户端的请求分配到各个服务端。

- 高可用

![images](/images/负载均衡.png)
如上图，客户可以通过抢注主机记录，实现服务的高可用。


## 架构介绍
UCloud 内网DNS集群，采用BGP+ECMP实现高可用及高扩展性。架构如下图：
![images](/images/DNS集群架构.png)

如上图所示，UCloud提供的UDNS服务是地域级别的产品。DNS集群可以认为是一个无状态的服务，每台服务器都可以独立对外提供服务。DNS服务器通过BGP对上游交换机宣告相同的VIP。DNS服务发生异常的时候，会宣告BGP的中断，从而将流量切换到其他服务器上，实现高可用。
